---
import MainLayout from "../layouts/mainLayout.astro"
import { getProjects } from "../services/server"
import { getRepos } from "../services/github"
import { Projects as ProjectsComponet } from "../components/Projects/Projects"
import { Pagination } from "../components/Pagination/Pagination"
import type { GetRepoResponse } from "../types/github";
import "../styles/pages/projects.scss"

const url = Astro.url
const stringPage = url.searchParams.get('page') || "1";
const queyPage = parseInt(stringPage)
const { repos, pagination }  = await getRepos(queyPage) as GetRepoResponse
const { pages, page } = pagination 
---

<MainLayout title={"Projects"}>
	<ProjectsComponet client:load projects={repos} />
	<Pagination client:load page={page} pages={pages} />
</MainLayout>